

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Deploying Test Device &#8212; Power Panel 1.0.0 documentation</title>
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Use Case Examples" href="use_cases.html" />
    <link rel="prev" title="Running the Server" href="server.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="use_cases.html" title="Use Case Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="server.html" title="Running the Server"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Power Panel 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="server.html"
                        title="previous chapter">Running the Server</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="use_cases.html"
                        title="next chapter">Use Case Examples</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/test_device.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="deploying-test-device">
<h1>Deploying Test Device<a class="headerlink" href="#deploying-test-device" title="Permalink to this headline">Â¶</a></h1>
<p>Create a raspbian sd card and add a wpa_supplicant.conf for your wifi network and an empty ssh file to initialize ssh so
ssh is enabled on the first boot. Boot up the raspberry pi, find it on your network and ssh into it.</p>
<p>Install Python 3.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install python3 python3-pip
</pre></div>
</div>
<p>Clone the Power Panel project to a directory of your choosing. Then install the package using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip3 install -e <span class="o">[</span>git repository directory<span class="o">]</span>
</pre></div>
</div>
<p>Create a configuration file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir ~/.powerpanel
cat &gt;~/.powerpanel/config.yml <span class="s">&lt;&lt;EOL</span>
<span class="s"># Human readable name of the device tester.</span>
<span class="s">name: [Name of Tester Device; ex Kitchen Outlet Tester]</span>
<span class="s"># Url of the server.</span>
<span class="s">endpoint_url: \http://[IP of Server]:[Server Port]</span>
<span class="s"># The frequency at which to register the device.</span>
<span class="s">reg_frequency: 1</span>
<span class="s"># NOTE: Must be smaller than the device_expiration time of the server.</span>
<span class="s">EOL</span>
</pre></div>
</div>
<p>Next create a script to run the tester</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat &gt;~/.powerpanel/tester.py <span class="s">&lt;&lt;EOL</span>
<span class="s">from powerpanel.power_tester import PowerTester</span>
<span class="s">power_tester = PowerTester()</span>
<span class="s">power_tester.run()</span>
<span class="s">EOL</span>
</pre></div>
</div>
<p>Add the following line to /etc/rc.local just before exit 0:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>su - pi -c <span class="s1">&#39;python3 ~/.powerpanel/tester.py&#39;</span>
</pre></div>
</div>
<p>Finally reboot the raspberry pi. After it boots you should see the testers name as specified in the yaml in the list of
devices. You can then deploy to multiple devices and plug them around the house or business you want to map the outlets
to and begin opening breakers and monitoring the list for devices which have disappeared off the server page, then
shutting the breaker to verify the device you expect returns.</p>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="use_cases.html" title="Use Case Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="server.html" title="Running the Server"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Power Panel 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, David Cheeseman.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.8.
    </div>
  </body>
</html>